pipeline {
    agent any
    stages {
        
        stage('clean Maven') {
            steps{
                script{
                    dir('DevOps_Project')
                    {sh "mvn clean" } 
                }
            }
        }
        
         stage('Compile') {
            steps {
                script {
                    dir('DevOps_Project')
                    {sh 'mvn compile'}
                }
            }
        }
        
        stage('Test') {
            steps {
                script {
                    dir('DevOps_Project') 
                    { sh 'mvn test' }
                }
            }
        }
        
          stage('Build') {
              steps {
                 script {
                    dir('DevOps_Project')
                    {sh 'mvn package '}
                }
            }
        }
        
         stage("Docker build") {
            steps {
                script {
                    dir('DevOps_Project')
                    {sh 'docker build -t fatma721/devops_project .'}
                }
            }
        }
          
       stage('SONARQUBE') {
            steps {
                script {
                    dir('DevOps_Project') {
                        // Use the 'SonarCreds' credential for SonarQube login
                        withCredentials([usernamePassword(credentialsId: 'SonarCreds', usernameVariable: 'SONAR_USERNAME', passwordVariable: 'SONAR_PASSWORD')]) {
                            sh "mvn sonar:sonar -Dsonar.login=\$SONAR_USERNAME -Dsonar.password=\$SONAR_PASSWORD"
                }
            }
        }
    }
       }
                
}
}
